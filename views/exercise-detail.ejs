<%- include('partials/header') %>

<div class="container">
  <nav class="breadcrumb">
    <a href="/exercises">Exercises</a>
    <span>/</span>
    <span><%= exercise.name %></span>
  </nav>

  <div class="detail-page">
    <div class="detail-header">
      <div class="detail-badges">
        <span class="badge"><%= exercise.category_name || 'General' %></span>
        <span class="badge badge-<%= exercise.difficulty %>"
          ><%= exercise.difficulty %></span
        >
      </div>
      <h1><%= exercise.name %></h1>
    </div>

    <div class="detail-content">
      <div class="detail-main">
        <% if (exercise.description) { %>
        <div class="detail-section">
          <h2>Description</h2>
          <p><%= exercise.description %></p>
        </div>
        <% } %> <% if (exercise.muscle_group) { %>
        <div class="detail-section">
          <h2>Muscle Groups Targeted</h2>
          <div class="muscle-tags">
            <% exercise.muscle_group.split(',').forEach(function(muscle) { %>
            <span class="tag"><%= muscle.trim() %></span>
            <% }); %>
          </div>
        </div>
        <% } %>
      </div>

      <div class="detail-sidebar">
        <div class="info-card">
          <h3>Exercise Info</h3>
          <dl class="info-list">
            <dt>Category</dt>
            <dd><%= exercise.category_name || 'General' %></dd>

            <dt>Difficulty</dt>
            <dd>
              <span class="badge badge-<%= exercise.difficulty %>"
                ><%= exercise.difficulty %></span
              >
            </dd>

            <% if (exercise.calories_per_minute) { %>
            <dt>Calories Burned</dt>
            <dd>~<%= exercise.calories_per_minute %> cal/min</dd>
            <% } %>
          </dl>

          <% if (user) { %>
          <a
            href="/workouts/new?exercise=<%= exercise.id %>"
            class="btn btn-primary btn-block"
            >Add to Workout</a
          >
          <% } else { %>
          <a href="/auth/login" class="btn btn-primary btn-block"
            >Login to Track</a
          >
          <% } %>
        </div>

        <% if (exercise.calories_per_minute) { %>
        <div class="info-card">
          <h3>Calorie Calculator</h3>
          <div class="calorie-calc">
            <label for="duration">Duration (minutes)</label>
            <input
              type="number"
              id="duration"
              value="30"
              min="1"
              max="300"
              class="form-input"
            />
            <p class="calc-result">
              Estimated burn:
              <strong id="calorieResult"
                ><%= Math.round(exercise.calories_per_minute * 30) %></strong
              >
              calories
            </p>
          </div>
        </div>

        <script>
          document.getElementById('duration').addEventListener('input', function() {
              const duration = parseInt(this.value) || 0;
              const caloriesPerMin = <%= exercise.calories_per_minute %>;
              document.getElementById('calorieResult').textContent = Math.round(duration * caloriesPerMin);
          });
        </script>
        <% } %>
      </div>
    </div>
  </div>

  <div class="back-link">
    <a href="/exercises" class="btn btn-outline">‚Üê Back to Exercise Library</a>
  </div>
</div>

<%- include('partials/footer') %>
